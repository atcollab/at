<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of talk</title>
  <meta name="keywords" content="talk">
  <meta name="description" content="TALK">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">atmat</a> &gt; <a href="index.html">atdemos</a> &gt; talk.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for atmat/atdemos&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>talk
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>TALK</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment">TALK</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="demoknob.html" class="code" title="">demoknob</a>	DEMOKNOB illustrates the use of MATLAB GUI controls with AT</li><li><a href="spear2.html" class="code" title="function spear2">spear2</a>	SPEAR2 example lattice definition file</li><li><a href="spear2rad.html" class="code" title="function spear2rad">spear2rad</a>	SPEAR2RAD example lattice definition file</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">%TALK</span>
0002 
0003 <span class="comment">% keeping notes and comments in lattice files</span>
0004 help <a href="spear2.html" class="code" title="function spear2">spear2</a>
0005 help <a href="spear2rad.html" class="code" title="function spear2rad">spear2rad</a>
0006 help sp3v81loco
0007 
0008 <span class="comment">% STUDY 1: load a file</span>
0009 <a href="spear2.html" class="code" title="function spear2">spear2</a>
0010 whos
0011 
0012 THERING{1:10}
0013 FAMLIST{1:10}
0014 
0015 <span class="comment">% Read MAD output</span>
0016 clear all
0017 THERING = readmad(<span class="string">'spear3_mad_structure.out'</span>);
0018 
0019 
0020 
0021 <span class="comment">% STUDY 2</span>
0022 <span class="comment">% LATTICE MANIPULATION</span>
0023 <span class="comment">% start over by clearing the workspace and loading spear2</span>
0024 clear all
0025 <a href="spear2.html" class="code" title="function spear2">spear2</a>;
0026 
0027 <span class="comment">% You may access/modify parameters of individual elements</span>
0028 <span class="comment">% in several ways</span>
0029 <span class="comment">% 1. Text mode is very useful to write your own scripts:</span>
0030 <span class="comment">%    for example</span>
0031 THERING{3} <span class="comment">% notice curly {} braces for cell access</span>
0032 <span class="comment">%    displays the data from the first Q3 quadrupole</span>
0033 <span class="comment">% THERING{i} is actually a MATLAB structure so you can</span>
0034 <span class="comment">% access individual fields using &quot;.&quot;</span>
0035 THERING{3}.R1 
0036 <span class="comment">% displays only the 6x6 entrance tilt matrix R1 for the same quadrupole</span>
0037 <span class="comment">% You may even access individual elements in that matrix</span>
0038 THERING{3}.R1(1,1)
0039 <span class="comment">% Try</span>
0040 getfield(THERING{3},<span class="string">'PassMethod'</span>) <span class="comment">% WATCH OUT -  you will get</span>
0041 <span class="comment">% MATLAB warnings if the field does not exist for that element</span>
0042 <span class="comment">% or if you misspell it. MATLAB is case sensitive</span>
0043 
0044 <span class="comment">% SEE ALSO MATLAB help on SETFIELD, GETFIELD, FIELDNAMES   funtions</span>
0045 <span class="comment">% useful for structure access / manipulation</span>
0046 fieldnames(THERING{3})
0047 <span class="comment">% returns the list of fields in for THERING{3}</span>
0048 <span class="comment">% In fact this list is common for all Q3</span>
0049 
0050 
0051 
0052 <span class="comment">% GUI Lattice manipulation</span>
0053 
0054 clear all
0055 <a href="spear2.html" class="code" title="function spear2">spear2</a> 
0056 <span class="comment">% Draw the ring - select and edit elements</span>
0057 intlat
0058 
0059 <span class="comment">% GUI editor of an elemet</span>
0060 intelem(3)
0061 
0062 <span class="comment">% GUI (slider) control of a 'K' parameter in</span>
0063 <span class="comment">% all QF and QD simultaneously</span>
0064 <a href="demoknob.html" class="code" title="">demoknob</a>
0065 
0066 
0067 <span class="comment">% STUDY3: TRACKING</span>
0068 <a href="spear2.html" class="code" title="function spear2">spear2</a>
0069 <span class="comment">% Use RINGPASS for tracking</span>
0070 help ringpass
0071 <span class="comment">% Input vectors must be Nx6 matrixes</span>
0072 X0 = [0.01 0 0 0 0 0]'
0073 <span class="comment">% Track 1 particle - 1 turn</span>
0074 X = ringpass(THERING,X0);
0075 
0076 <span class="comment">% Track 1 particle - 10 turns</span>
0077 X = ringpass(THERING,X0,10)
0078 
0079 <span class="comment">% Track 3 particles - 10 turns</span>
0080 X0 = [X0 X0 X0]
0081 X = ringpass(THERING,X0,10)
0082 
0083 
0084 
0085 <span class="comment">% Using results of tracking for accelearator physics calculations in MATLAB</span>
0086 X0 = [0.001 0 0 0 0 0]';
0087 <span class="comment">% Track 1 particle - 200 turns</span>
0088 clear X
0089 X = ringpass(THERING,X0,200);
0090 plot(X(1,:),<span class="string">'.'</span>)
0091 xlabel(<span class="string">'Turn Number'</span>);
0092 ylabel(<span class="string">'X [mm]'</span>);
0093 figure
0094 plot(X(1,:),X(2,:),<span class="string">'.'</span>)
0095 title(<span class="string">'Phase Space'</span>);
0096 figure
0097 xspectrum = abs(fft(X(1,:)));
0098 plot(xspectrum)
0099 title(<span class="string">'FFT'</span>);
0100 
0101 
0102 <span class="comment">% Plot phase-space near 1/3 integer resonance</span>
0103 clear all; close all
0104 <a href="spear2.html" class="code" title="function spear2">spear2</a>
0105 fittune2([0.345 0.26],<span class="string">'QF'</span>,<span class="string">'QD'</span>);
0106 X0 = [0.001 0 0 0 0 0]'*(1:15);
0107 <span class="comment">% Track 15 particles - 200 turns</span>
0108 clear X
0109 X = ringpass(THERING,X0,200);
0110 figure
0111 plot(X(1,:),X(2,:),<span class="string">'.'</span>)
0112 title(<span class="string">'Phase Space'</span>);
0113 
0114 
0115 
0116 <span class="comment">% Low-level element pass method</span>
0117 X0 = [0.001 0 0 0 0 0]';
0118 X1 = QuadLinearPass(THERING{5},X0)
0119 X2 = DriftPass(THERING{6},X1)
0120 
0121 
0122 
0123 <span class="comment">% Many physics routines call RINGPASS, LINEPASS</span>
0124 <span class="comment">% or one of the element-level mex-functions</span>
0125 
0126 
0127 <span class="comment">% Example 1: CLOSED ORBIT CALCULATION</span>
0128 clear all
0129 <a href="spear2.html" class="code" title="function spear2">spear2</a>
0130 
0131 plotcod(THERING,0)
0132 <span class="comment">% use intlat to set ByError in one of the bends</span>
0133 
0134 plotcod(THERING,0)
0135 <span class="comment">% Behold horizontally distorted orbit</span>
0136 
0137 clear all
0138 clf
0139 <a href="spear2.html" class="code" title="function spear2">spear2</a>
0140 plotcod(THERING,0)
0141 <span class="comment">% use intlat to set T1,T2 in one of the quads</span>
0142 <span class="comment">% to T1 = [0.001 0 0.001 0 0 0]; T2= -T1;</span>
0143 plotcod(THERING,0)
0144 <span class="comment">% Behold orbit distortion in both planes</span>
0145 
0146 
0147 <span class="comment">% Example 2: Make a script to calculate</span>
0148 <span class="comment">% Momentum Compaction Factor</span>
0149 
0150 <span class="comment">% Lets calculate momentum compaction factor:</span>
0151 <span class="comment">% dL = alpha*L*dP/P</span>
0152 
0153 <span class="comment">% Find off-energy fixed point</span>
0154 dP = 0.001
0155 fp = findorbit(THERING,dP)
0156 format long
0157 
0158 <span class="comment">% Build initial condition vector that starts</span>
0159 <span class="comment">% on the fixed point</span>
0160 X0 = fp;
0161 X0(5) = dP;
0162 X0(6) = 0;
0163 X0
0164 <span class="comment">% Track X0 for 1 turn</span>
0165 X1 = ringpass(THERING,X0)
0166 <span class="comment">% Calculate momentum compaction factor</span>
0167 alpha = X1(6)/(dP*234)
0168 
0169 <span class="comment">% EXAMPLE 3. Beta-functions and tunes</span>
0170 clear all
0171 <a href="spear2.html" class="code" title="function spear2">spear2</a>
0172 plotbeta
0173 <span class="comment">% Use demoknob to tweek quad values</span>
0174 <a href="demoknob.html" class="code" title="">demoknob</a>
0175 plotbeta
0176 
0177</pre></div>
<hr><address>Generated on Sun 28-Jul-2013 23:18:56 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>