<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2021b"><title>Controlling the RF cavities</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin-bottom: 20px; padding-bottom: 4px;  }
.S2 { margin: 0px; padding: 10px 0px 10px 5px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 700; text-align: start;  }
.S3 { margin: -1px 0px 0px; padding: 10px 0px 10px 7px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: start;  }
.S4 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S5 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S6 { margin: 15px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 17px; font-weight: 700; text-align: left;  }
.S7 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif; font-size: 14px;  }
.S8 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }</style></head><body><div class = rtcContent><h1  class = 'S0' id = 'T_703E94F3' ><span>Controlling the RF cavities</span></h1><div  class = 'S1'><div  class = 'S2'><span style=' font-weight: bold;'>Table of Contents</span></div><div  class = 'S3'><a href = "#H_0C7B2124"><span>Lattice attributes
</span></a><a href = "#H_6A367191"><span>Cavity access
</span></a><span>    </span><a href = "#H_227E0725"><span>Selection of the target cavities
</span></a><span>    </span><a href = "#H_ADBD8F72"><span>Cavity attributes</span></a></div></div><div  class = 'S4'><span>A lattice may contain multiple RF cavities, grouped according to different RF systems:</span></div><div  class = 'S4'><span>main cavities, harmonic cavities… AT provides simple tools to tune them.</span></div><h2  class = 'S5' id = 'H_0C7B2124' ><span>Lattice attributes</span></h2><div  class = 'S4'><span>Lattice attributes are used to describe global properties of the lattice. They are stored as attributes of a </span><span style=' font-family: monospace;'>RingParam</span><span> element, ideally located in the 1st position in the lattice.</span></div><div  class = 'S4'><span>The lattice attributes can be accessed with the </span><a href = "matlab:doc('atSetRingProperties')"><span>atSetRingProperties</span></a><span> / </span><a href = "matlab:doc('atGetRingProperties')"><span>atGetRingProperties</span></a><span> functions.</span></div><div  class = 'S4'><span>Two lattice attributes are used by the cavity control:</span></div><div  class = 'S4'><span>The '</span><span style=' font-family: monospace;'>Periodicity'</span><span> attribute is the number of times the lattice cell is repeated to build the ring,</span></div><div  class = 'S4'><span>An optional </span><span style=' font-family: monospace;'>'cavpts'</span><span> attribute may be used to select the cavities, as explained </span><a href = "#H_227E0725"><span>below</span></a><span>.</span></div><h2  class = 'S5' id = 'H_6A367191' ><span>Cavity access</span></h2><div  class = 'S4'><span>Cavity parameters are set with the </span><a href = "matlab:doc('atsetcavity')"><span>atsetcavity</span></a><span> function.</span></div><div  class = 'S4'><span style=' font-family: monospace;'>newring=atsetcavity(ring,'Name',Value)</span><span> specifies cavity properties using one or more </span><span style=' font-family: monospace;'>Name,Value</span><span> pair arguments. The values handled by the function concern the full ring (</span><span style=' font-style: italic;'>`periodicity` </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(0, 0, 0);">x</span><span> cell).</span></div><h3  class = 'S6' id = 'H_227E0725' ><span>Selection of the target cavities</span></h3><div  class = 'S4'><span>The </span><span style=' font-family: monospace;'>`cavpts`</span><span style=' font-style: italic;'> </span><span>argument is used to select the cavities driven by the command.</span></div><div  class = 'S4'><span style=' font-family: monospace;'>newring=atsetcavity(ring,___,'cavpts',cavpts)</span><span> </span></div><div  class = 'S4'><span>It is used as follows:</span></div><ul  class = 'S7'><li  class = 'S8'><span style=' font-family: monospace;'>cavpts</span><span style=' font-style: italic;'> </span><span>is a "refpts" type (integer or logical array): it is used to select the cavities,</span></li><li  class = 'S8'><span style=' font-family: monospace;'>cavpts </span><span>is empty (default value), and the lattice has a </span><span style=' font-family: monospace;'>'cavpts'</span><span style=' font-style: italic;'> </span><span>attribute: the lattice attribute is used to select the cavities,</span></li><li  class = 'S8'><span style=' font-family: monospace;'>cavpts</span><span> is empty, and the lattice has no </span><span style=' font-family: monospace;'>'cavpts'</span><span> attribute (or it is empty): all cavities are selected.</span></li></ul><div  class = 'S4'><span>So the easier way to use it is:</span></div><ul  class = 'S7'><li  class = 'S8'><span style=' font-weight: bold;'>single RF system</span><span> (main cavities): forget the </span><span style=' font-family: monospace;'>cavpts</span><span> argument. The default is to use all cavities,</span></li><li  class = 'S8'><span style=' font-weight: bold;'>main RF system + harmonic system</span><span>: set the lattice </span><span style=' font-family: monospace;'>'cavpts' </span><span>attribute to the location of the main cavities, so that the default behaviour is to drive the main system. Use the function's </span><span style=' font-family: monospace;'>'cavpts'</span><span style=' font-style: italic;'> </span><span>argument to drive the harmonic cavities.</span></li></ul><h3  class = 'S6' id = 'H_ADBD8F72' ><span>Cavity attributes</span></h3><div  class = 'S4'><span></span></div><div  class = 'S4'><span style=' font-family: monospace;'>newring=atsetcavity(ring,___,'Frequency',frf)</span><span> </span></div><div  class = 'S4'><span style=' font-family: monospace;'>newring=atsetcavity(ring,___,'Frequency','nominal')</span><span> </span></div><div  class = 'S4'><span>    If the frequency is </span><span style=' font-family: monospace;'>'nominal'</span><span>, the function will set the frequency to the nominal value, according to the revolution frequency and harmonic number. An optional off-momentum may be applied using the</span><span> '</span><span style=' font-family: monospace;'>dp'</span><span> </span><span>or</span><span> '</span><span style=' font-family: monospace;'>dct'</span><span> </span><span>arguments. The frequency shift is then computed using the linear slip factor </span><span texencoding="$\eta_c = 1/\gamma^2 - \alpha_c$" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="90" height="21" /></span><span> , so that the resulting</span><span> dp </span><span>may slighly differ from the specified value.</span></div><div  class = 'S4'><span></span></div><div  class = 'S4'><span style=' font-family: monospace;'>newring=atsetcavity(ring,___,'HarmNumber',h)</span><span> </span></div><div  class = 'S4'><span>    Set the ring harmonic number of the full ring (all cells). The harmonic number of each cavity is h / Periodicity</span></div><div  class = 'S4'><span></span></div><div  class = 'S4'><span style=' font-family: monospace;'>newring=atsetcavity(ring,___,'Voltage',Vrf)</span><span> </span></div><div  class = 'S4'><span>    Set the total voltage (all cells) [V]. The voltage is equally distributed over all selected cavities in all cells. So the voltage of each cavity is Vrf / n_cavities / Periodicity.</span></div><div  class = 'S4'><span></span></div><div  class = 'S4'><span style=' font-family: monospace;'>newring=atsetcavity(ring,___,'Timelag',time_lag)</span><span> </span></div><div  class = 'S4'><span>   The time lag is expressed in values of path lengthening “cτ”, the 6</span><span>th</span><span> </span><span>particle coordinate [m].</span></div><div  class = 'S4'><span></span></div><div  class = 'S4'><span style=' font-family: monospace;'>newring=atsetcavity(ring,___,'dp',dp)</span><span> </span></div><div  class = 'S4'><span style=' font-family: monospace;'>newring=atsetcavity(ring,___,'dct',dct)</span><span> </span></div><div  class = 'S4'><span>   Set the off-momentum used to compute the nominal RF frequency.</span></div><div  class = 'S4'><span></span></div><div  class = 'S4'></div>
<br>
<!-- 
##### SOURCE BEGIN #####
%% Controlling the RF cavities
%% 
% A lattice may contain multiple RF cavities, grouped according to different 
% RF systems:
% 
% main cavities, harmonic cavities… AT provides simple tools to tune them.
%% Lattice attributes
% Lattice attributes are used to describe global properties of the lattice. 
% They are stored as attributes of a |RingParam| element, ideally located in the 
% 1st position in the lattice.
% 
% The lattice attributes can be accessed with the <matlab:doc('atSetRingProperties') 
% atSetRingProperties> / <matlab:doc('atGetRingProperties') atGetRingProperties> 
% functions.
% 
% Two lattice attributes are used by the cavity control:
% 
% The '|Periodicity'| attribute is the number of times the lattice cell is repeated 
% to build the ring,
% 
% An optional |'cavpts'| attribute may be used to select the cavities, as explained 
% below.
%% Cavity access
% Cavity parameters are set with the <matlab:doc('atsetcavity') atsetcavity> 
% function.
% 
% |newring=atsetcavity(ring,'Name',Value)| specifies cavity properties using 
% one or more |Name,Value| pair arguments. The values handled by the function 
% concern the full ring (_`periodicity`_ $x$ cell).
% Selection of the target cavities
% The |`cavpts`| argument is used to select the cavities driven by the command.
% 
% |newring=atsetcavity(ring,___,'cavpts',cavpts)| 
% 
% It is used as follows:
%% 
% * |cavpts| is a "refpts" type (integer or logical array): it is used to select 
% the cavities,
% * |cavpts| is empty (default value), and the lattice has a |'cavpts'| attribute: 
% the lattice attribute is used to select the cavities,
% * |cavpts| is empty, and the lattice has no |'cavpts'| attribute (or it is 
% empty): all cavities are selected.
%% 
% So the easier way to use it is:
%% 
% * *single RF system* (main cavities): forget the |cavpts| argument. The default 
% is to use all cavities,
% * *main RF system + harmonic system*: set the lattice |'cavpts'| attribute 
% to the location of the main cavities, so that the default behaviour is to drive 
% the main system. Use the function's |'cavpts'| argument to drive the harmonic 
% cavities.
% Cavity attributes
% 
% 
% |newring=atsetcavity(ring,___,'Frequency',frf)| 
% 
% |newring=atsetcavity(ring,___,'Frequency','nominal')| 
% 
% If the frequency is |'nominal'|, the function will set the frequency to the 
% nominal value, according to the revolution frequency and harmonic number. An 
% optional off-momentum may be applied using the '|dp'| or '|dct'| arguments. 
% The frequency shift is then computed using the linear slip factor $$\eta_c = 
% 1/\gamma^2 - \alpha_c$$ , so that the resulting dp may slighly differ from the 
% specified value.
% 
% 
% 
% |newring=atsetcavity(ring,___,'HarmNumber',h)| 
% 
% Set the ring harmonic number of the full ring (all cells). The harmonic number 
% of each cavity is h / Periodicity
% 
% 
% 
% |newring=atsetcavity(ring,___,'Voltage',Vrf)| 
% 
% Set the total voltage (all cells) [V]. The voltage is equally distributed 
% over all selected cavities in all cells. So the voltage of each cavity is Vrf 
% / n_cavities / Periodicity.
% 
% 
% 
% |newring=atsetcavity(ring,___,'Timelag',time_lag)| 
% 
% The time lag is expressed in values of path lengthening “cτ”, the 6th particle 
% coordinate [m].
% 
% 
% 
% |newring=atsetcavity(ring,___,'dp',dp)| 
% 
% |newring=atsetcavity(ring,___,'dct',dct)| 
% 
% Set the off-momentum used to compute the nominal RF frequency.
% 
% 
% 
%
##### SOURCE END #####
-->
</div></body></html>