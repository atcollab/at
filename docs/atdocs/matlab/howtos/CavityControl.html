<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2022a"><title>Controlling the RF cavities</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(192, 76, 11); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin-bottom: 20px; padding-bottom: 4px;  }
.S2 { margin: 0px; padding: 10px 0px 10px 5px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 700; text-align: start;  }
.S3 { margin: -1px 0px 0px; padding: 10px 0px 10px 7px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: start;  }
.S4 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S5 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S6 { margin: 15px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 17px; font-weight: 700; text-align: left;  }
.S7 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif; font-size: 14px;  }
.S8 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }</style></head><body><div class = rtcContent><h1  class = 'S0' id = 'T_703E94F3' ><span>Controlling the RF cavities</span></h1><div  class = 'S1'><div  class = 'S2'><span style=' font-weight: bold;'>Table of Contents</span></div><div  class = 'S3'><a href = "#H_0C7B2124"><span>Lattice properties
</span></a><a href = "#H_309107A0"><span>Cavity access function
</span></a><span>    </span><a href = "#H_227E0725"><span>Selection of the target cavities
</span></a><span>    </span><a href = "#H_ADBD8F72"><span>Cavity attributes</span></a></div></div><div  class = 'S4'><span>A lattice may contain multiple RF cavities, grouped according to different RF systems:</span></div><div  class = 'S4'><span>main cavities, harmonic cavities… AT provides simple tools to tune them.</span></div><h2  class = 'S5' id = 'H_0C7B2124' ><span>Lattice properties</span></h2><div  class = 'S4'><span>Lattice properties are used to describe global properties of the lattice. They are stored as attributes of a </span><span style=' font-family: monospace;'>RingParam</span><span> element, ideally located in the 1st position in the lattice.</span></div><div  class = 'S4'><span>The lattice properties can be accessed with the </span><a href = "matlab:doc('atSetRingProperties')"><span>atSetRingProperties</span></a><span> / </span><a href = "matlab:doc('atGetRingProperties')"><span>atGetRingProperties</span></a><span> functions.</span></div><div  class = 'S4'><span>Several lattice properties are used for cavity control. They act on the cavities selected by the </span><span style=' font-family: monospace;'>cavpts</span><span> property, initially pointing to the cavities with the lowest frequency.</span></div><div  class = 'S4'><span>'</span><span style=' font-family: monospace;'>Periodicity':</span><span> read/write - The number of times the lattice cell is repeated to build the ring,</span></div><div  class = 'S4'><span style=' font-family: monospace;'>'cavpts'</span><span>: read/write </span><span style=' font-family: monospace;'>-</span><span> select the cavities, as explained </span><a href = "#H_227E0725"><span>below</span></a><span>.</span></div><div  class = 'S4'><span>'</span><span style=' font-family: monospace;'>rf_frequency':</span><span> read/write - The frequency of the main cavities (cavities with thr lowest frequency</span></div><div  class = 'S4'><span>'</span><span style=' font-family: monospace;'>rf_timelag':</span><span> read/write - The time lag of the main cavities expressed in values of path lengthening “cτ”, the 6th particle coordinate [m].</span></div><div  class = 'S4'><span>'</span><span style=' font-family: monospace;'>rf_voltage':</span><span> read/write - THe sum of the voltages of all main cavities over the full ring</span></div><div  class = 'S4'><span>'</span><span style=' font-family: monospace;'>cell_rf_voltage':</span><span> read/write - Sum of the voltages of all main cavities over one cell</span></div><h2  class = 'S5' id = 'H_309107A0' ><span>Cavity access function</span></h2><div  class = 'S4'><span>More control of the cavity parameters can be acheived with the </span><a href = "matlab:doc('atsetcavity')"><span>atsetcavity</span></a><span> function.</span></div><div  class = 'S4'><span style=' font-family: monospace;'>newring=atsetcavity(ring,'Name',Value,...)</span><span> specifies cavity properties using one or more </span><span style=' font-family: monospace;'>Name,Value</span><span> pair arguments. The values handled by the function concern the full ring (</span><span style=' font-style: italic;'>`periodicity` </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(33, 33, 33);">x</span><span> cell).</span></div><h3  class = 'S6' id = 'H_227E0725' ><span>Selection of the target cavities</span></h3><div  class = 'S4'><span>The </span><span style=' font-family: monospace;'>`cavpts`</span><span style=' font-style: italic;'> </span><span>argument is used to select the cavities driven by the command.</span></div><div  class = 'S4'><span style=' font-family: monospace;'>newring=atsetcavity(ring,___,'cavpts',cavpts)</span><span> </span></div><div  class = 'S4'><span>It is used as follows:</span></div><ul  class = 'S7'><li  class = 'S8'><span style=' font-family: monospace;'>cavpts</span><span style=' font-style: italic;'> </span><span>is a "refpts" type (integer or logical array): it is used to select the cavities,</span></li><li  class = 'S8'><span style=' font-family: monospace;'>cavpts </span><span>is empty (default value), and the lattice has a </span><span style=' font-family: monospace;'>'cavpts'</span><span style=' font-style: italic;'> </span><span>attribute: the lattice attribute is used to select the cavities,</span></li><li  class = 'S8'><span style=' font-family: monospace;'>cavpts</span><span> is empty, and the lattice has no </span><span style=' font-family: monospace;'>'cavpts'</span><span> attribute (or it is empty): all cavities are selected.</span></li></ul><div  class = 'S4'><span>So the easier way to use it is:</span></div><ul  class = 'S7'><li  class = 'S8'><span style=' font-weight: bold;'>single RF system</span><span> (main cavities): forget the </span><span style=' font-family: monospace;'>cavpts</span><span> argument. The default is to use all cavities,</span></li><li  class = 'S8'><span style=' font-weight: bold;'>main RF system + harmonic system</span><span>: set the lattice </span><span style=' font-family: monospace;'>'cavpts' </span><span>attribute to the location of the main cavities, so that the default behaviour is to drive the main system. Use the function's </span><span style=' font-family: monospace;'>'cavpts'</span><span style=' font-style: italic;'> </span><span>argument to drive the harmonic cavities.</span></li></ul><h3  class = 'S6' id = 'H_ADBD8F72' ><span>Cavity attributes</span></h3><div  class = 'S4'><span></span></div><div  class = 'S4'><span style=' font-family: monospace;'>newring=atsetcavity(ring,___,'Frequency',frf)</span><span> </span></div><div  class = 'S4'><span style=' font-family: monospace;'>newring=atsetcavity(ring,___,'Frequency','nominal')</span><span> </span></div><div  class = 'S4'><span>    If the frequency is </span><span style=' font-family: monospace;'>'nominal'</span><span>, the function will set the frequency to the nominal value, according to the revolution frequency and harmonic number. An optional off-momentum may be applied using the</span><span> '</span><span style=' font-family: monospace;'>dp'</span><span> </span><span>or</span><span> '</span><span style=' font-family: monospace;'>dct'</span><span> </span><span>arguments. The frequency shift is then computed using the linear slip factor </span><span texencoding="$\eta_c = 1/\gamma^2 - \alpha_c$" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="87" height="21" /></span><span> , so that the resulting</span><span> dp </span><span>may slighly differ from the specified value.</span></div><div  class = 'S4'><span></span></div><div  class = 'S4'><span style=' font-family: monospace;'>newring=atsetcavity(ring,___,'Voltage',Vrf)</span><span> </span></div><div  class = 'S4'><span>    Set the total voltage (all cells) [V]. The voltage is equally distributed over all selected cavities in all cells. So the voltage of each cavity is Vrf / n_cavities / Periodicity.</span></div><div  class = 'S4'><span></span></div><div  class = 'S4'><span style=' font-family: monospace;'>newring=atsetcavity(ring,___,'cell_voltage',Vrf)</span><span> </span></div><div  class = 'S4'><span>    Set the voltage of one cell [V]. The voltage is equally distributed over all selected cavities in the cell. So the voltage of each cavity is Vrf / n_cavities.</span></div><div  class = 'S4'><span></span></div><div  class = 'S4'><span style=' font-family: monospace;'>newring=atsetcavity(ring,___,'Timelag',time_lag)</span><span> </span></div><div  class = 'S4'><span>   The time lag is expressed in values of path lengthening “cτ”, the 6</span><span>th</span><span> </span><span>particle coordinate [m].</span></div><div  class = 'S4'><span></span></div><div  class = 'S4'><span style=' font-family: monospace;'>newring=atsetcavity(ring,___,'dp',dp)</span><span> </span></div><div  class = 'S4'><span style=' font-family: monospace;'>newring=atsetcavity(ring,___,'dct',dct)</span><span> </span></div><div  class = 'S4'><span>   Set the off-momentum used to compute the nominal RF frequency.</span></div><div  class = 'S4'><span></span></div><div  class = 'S4'></div>
<br>
<!-- 
##### SOURCE BEGIN #####
%% Controlling the RF cavities
%% 
% A lattice may contain multiple RF cavities, grouped according to different 
% RF systems:
% 
% main cavities, harmonic cavities… AT provides simple tools to tune them.
%% Lattice properties
% Lattice properties are used to describe global properties of the lattice. 
% They are stored as attributes of a |RingParam| element, ideally located in the 
% 1st position in the lattice.
% 
% The lattice properties can be accessed with the <matlab:doc('atSetRingProperties') 
% atSetRingProperties> / <matlab:doc('atGetRingProperties') atGetRingProperties> 
% functions.
% 
% Several lattice properties are used for cavity control. They act on the cavities 
% selected by the |cavpts| property, initially pointing to the cavities with the 
% lowest frequency.
% 
% '|Periodicity':| read/write - The number of times the lattice cell is repeated 
% to build the ring,
% 
% |'cavpts'|: read/write |-| select the cavities, as explained below.
% 
% '|rf_frequency':| read/write - The frequency of the main cavities (cavities 
% with thr lowest frequency
% 
% '|rf_timelag':| read/write - The time lag of the main cavities expressed in 
% values of path lengthening “cτ”, the 6th particle coordinate [m].
% 
% '|rf_voltage':| read/write - THe sum of the voltages of all main cavities 
% over the full ring
% 
% '|cell_rf_voltage':| read/write - Sum of the voltages of all main cavities 
% over one cell
%% Cavity access function
% More control of the cavity parameters can be acheived with the <matlab:doc('atsetcavity') 
% atsetcavity> function.
% 
% |newring=atsetcavity(ring,'Name',Value,...)| specifies cavity properties using 
% one or more |Name,Value| pair arguments. The values handled by the function 
% concern the full ring (_`periodicity`_ $x$ cell).
% Selection of the target cavities
% The |`cavpts`| argument is used to select the cavities driven by the command.
% 
% |newring=atsetcavity(ring,___,'cavpts',cavpts)| 
% 
% It is used as follows:
%% 
% * |cavpts| is a "refpts" type (integer or logical array): it is used to select 
% the cavities,
% * |cavpts| is empty (default value), and the lattice has a |'cavpts'| attribute: 
% the lattice attribute is used to select the cavities,
% * |cavpts| is empty, and the lattice has no |'cavpts'| attribute (or it is 
% empty): all cavities are selected.
%% 
% So the easier way to use it is:
%% 
% * *single RF system* (main cavities): forget the |cavpts| argument. The default 
% is to use all cavities,
% * *main RF system + harmonic system*: set the lattice |'cavpts'| attribute 
% to the location of the main cavities, so that the default behaviour is to drive 
% the main system. Use the function's |'cavpts'| argument to drive the harmonic 
% cavities.
% Cavity attributes
% 
% 
% |newring=atsetcavity(ring,___,'Frequency',frf)| 
% 
% |newring=atsetcavity(ring,___,'Frequency','nominal')| 
% 
% If the frequency is |'nominal'|, the function will set the frequency to the 
% nominal value, according to the revolution frequency and harmonic number. An 
% optional off-momentum may be applied using the '|dp'| or '|dct'| arguments. 
% The frequency shift is then computed using the linear slip factor $$\eta_c = 
% 1/\gamma^2 - \alpha_c$$ , so that the resulting dp may slighly differ from the 
% specified value.
% 
% 
% 
% |newring=atsetcavity(ring,___,'Voltage',Vrf)| 
% 
% Set the total voltage (all cells) [V]. The voltage is equally distributed 
% over all selected cavities in all cells. So the voltage of each cavity is Vrf 
% / n_cavities / Periodicity.
% 
% 
% 
% |newring=atsetcavity(ring,___,'cell_voltage',Vrf)| 
% 
% Set the voltage of one cell [V]. The voltage is equally distributed over all 
% selected cavities in the cell. So the voltage of each cavity is Vrf / n_cavities.
% 
% 
% 
% |newring=atsetcavity(ring,___,'Timelag',time_lag)| 
% 
% The time lag is expressed in values of path lengthening “cτ”, the 6th particle 
% coordinate [m].
% 
% 
% 
% |newring=atsetcavity(ring,___,'dp',dp)| 
% 
% |newring=atsetcavity(ring,___,'dct',dct)| 
% 
% Set the off-momentum used to compute the nominal RF frequency.
% 
% 
% 
%
##### SOURCE END #####
-->
</div></body></html>